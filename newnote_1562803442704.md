# 使用Sonar分析Jhipster代码质量

## 一、Jhipster官方文档中的说明：
> JHipster为Sonar提供了Docker Compose配置,在项目跟目录下启动sonar:
```shell
docker-compose -f src/main/docker/sonar.yml up -d
```

> 如果使用maven，则会自动配置它：

```shell
./mvnw -Pprod clean test sonar:sonar
```

> 如果使用Gradle，它也会自动配置：

```shell
./gradlew -Pprod clean test sonarqube
```
> 分析完成后，Sonar仪表板将显示该信息，默认情况下, 默认可以在http://127.0.0.1:9001/查看分析结果.

### 自动代码分析
> JHipster生成器项目发布一个示例项目，每次在“master”分支中合并一个新的提交时都会分析该示例项目：

[Analysis of the sample JHipster project](https://sonarcloud.io/dashboard?id=io.github.jhipster.sample%3Ajhipster-sample-application)

> 这允许JHipster团队确保您将开始在尽可能干净的代码上开发项目。
此分析由 [SonarCloud](https://sonarcloud.io/)免费提供。

## 二、我的实验环境

我在两台机器上做实验，项目代码在本机的e:\home\e2e-test目录下，sanor服务器部署在装有git
和docker的linux机器192.168.3.69上.

## 三、实验步骤

### 1、服务器上安装并启动sonar服务

```shell
mkdir /opt/sonar
cd /opt/sonar
#复制本机的E:\home\e2e-test\src\main\docker\sonar.yml到/opt/sonar目录
winscp……
# 启动sonar
docker-compose -f sonar.yml up -d
# 进入容器安装中文语言包，容器的名称是docker_<JH项目名>-sonar_1(可查看sonar.yml)
docker exec -it  docker_e2e-sonar_1 bash
cd /opt/sonarqube/extensions/plugins
wget https://github.com/SonarQubeCommunity/sonar-l10n-zh/releases/download/sonar-l10n-zh-plugin-1.27/sonar-l10n-zh-plugin-1.27.jar
#下载完毕，退出容器，重新启动容器
exit
docker restart docker_e2e-sonar_1 
# 访问http://192.168.3.69:9001就可以看到中文界面了
```
### 2、本机安装声呐扫描器sonar-scanner并开始扫描jhipster项目
#### 修改项目根沐浴露下声呐配置文件sonar-project.properties

```
sonar.host.url=http://192.168.3.69:9001


```


### 3、访问http://192.168.3.69:9001查看项目质量分析报告

